/*! For license information please see index.js.LICENSE.txt */
/* eslint-disable */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):"object"==typeof exports?exports.library=t(require("vue")):e.library=t(e.vue)}("undefined"!=typeof self?self:this,(function(e){return function(){"use strict";var t={748:function(t){t.exports=e}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return function(){function e(){for(var t={},n=function(e){return"object"===Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},r=function(r,o){n(t[o])&&n(r)?t[o]=e(t[o],r):n(r)?t[o]=e({},r):Array.isArray(r)?t[o]=r.slice():t[o]=r},o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return i.forEach((function(e){if(e)for(var t=Object.keys(e),n=0,o=t.length;n<o;n++){var i=t[n],a=e[i];r.call(null,a,i)}})),t}r.r(o),r.d(o,{MediaRecorder:function(){return W},default:function(){return v},useMediaInVue:function(){return Z}});var t={video:{aspectRatio:4/3},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},mirror:!0},n=function(){return["video/webm;codecs=vp9","video/webm;codecs=vp8","video/mp4","video/webm","video/ogg","video/quicktime","video/webm;codecs=daala","video/webm;codecs=h264","video/mpeg"].filter((function(e){return MediaRecorder.isTypeSupported(e)}))};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){var r,o,a;r=e,o=t,a=n[t],(o=function(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={NOT_SUPPORT:{code:"NOT_SUPPORT",message:{zh:"浏览器版本过低",en:"Browser version not support"}},NOT_PERMISSION:{code:"NOT_PERMISSION",message:{zh:"摄像头未授权",en:"Camera not permission"}}},l={NOT_SECURE:{code:"NOT_SECURE",message:{zh:"执行环境不安全",en:"Not secure"}},MEDIA_VIDEO_UNDEFINED:{code:"MEDIA_VIDEO_UNDEFINED",message:{zh:"mediaVideo元素未声明",en:"Media video element is necessary!"}},NOT_OPEN:{code:"NOT_OPEN",message:{zh:"未开启摄像",en:"Media not open"}}};function d(e){var t=s(s({},c),l)[e],n=t.code,r=t.message,o=r.zh;return r.en,new Error(o,{cause:n})}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function f(){f=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new N(r||[]);return o(a,"_invoke",{value:C(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",v="suspendedYield",m="executing",y="completed",g={};function b(){}function w(){}function x(){}var k={};l(k,a,(function(){return this}));var O=Object.getPrototypeOf,E=O&&O(O(T([])));E&&E!==n&&r.call(E,a)&&(k=E);var S=x.prototype=b.prototype=Object.create(k);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(o,i,a,s){var c=h(e[o],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==u(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,n,r){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=R(s,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=h(t,n,r);if("normal"===l.type){if(o=r.done?y:v,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function R(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,R(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=h(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(u(t)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},_(P.prototype),l(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new P(d(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(S),l(S,c,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function h(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===u(o)?o:String(o)),r)}var o}var v=function(){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.defaults=t,this.config={},this.isSecureOrigin=window.isSecureContext||"https:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname,this.stream=null,this.mediaRecorder=null,this.recordedBlobs=[],this.create(e)}var o,i,a,s;return o=r,i=[{key:"create",value:function(t){var n=t.mediaVideo,r=t.recordVideo,o=t.config,i=void 0===o?{}:o;this.opened=!1,this.mediaVideo=n,this.recordVideo=r,this.config=e(this.defaults,this.config,i),this.config.mirror&&(this.mediaVideo&&(this.mediaVideo.style.transform="rotateY(180deg)"),this.recordVideo&&this.recordVideo.classList.add("reversed"))}},{key:"getMediaAuth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.video,n=void 0===t||t,r=e.audio,o=void 0===r||r;return this.isSecureOrigin?navigator.mediaDevices?navigator.mediaDevices.getUserMedia({video:n,audio:o}).then((function(e){return e}),(function(e){return console.error(e),Promise.reject(d("NOT_PERMISSION"))})):Promise.reject(d("NOT_SUPPORT")):Promise.reject(d("NOT_SECURE"))}},{key:"open",value:function(){var e=this;if(!this.mediaVideo)return Promise.reject(d("MEDIA_VIDEO_UNDEFINED"));var t=this.config,n=t.video,r=void 0===n||n,o=t.audio,i=void 0===o||o;return this.getMediaAuth({video:r,audio:i}).then((function(t){return e.opened=!0,e.stream=t,e.mediaVideo.srcObject=t,t})).catch((function(e){return console.error(e),Promise.reject(e)}))}},{key:"close",value:function(){this.stream&&(this.stream.getTracks().forEach((function(e){e.stop&&e.stop()})),this.stream=null,this.mediaVideo.srcObject=null)}},{key:"getRecorderAuth",value:function(){return window.MediaRecorder&&n().length>0}},{key:"getMediaRecorder",value:function(e,t){return new Promise((function(n,r){try{n(new MediaRecorder(e,t))}catch(e){r(e),console.error(e)}}))}},{key:"startRecorder",value:(a=f().mark((function e(){var t,r,o,i,a=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getRecorderAuth()){e.next=2;break}return e.abrupt("return",Promise.reject(d("NOT_SUPPORT")));case 2:if(this.opened){e.next=4;break}return e.abrupt("return",Promise.reject(d("NOT_OPEN")));case 4:this.recordedBlobs=[],t=n(),r=t.map((function(e){return{mimeType:e,bitsPerSecond:1e7}})),o=0;case 8:if(!(o<r.length)){e.next=24;break}return i=r[o],e.prev=10,e.next=13,this.getMediaRecorder(this.stream,i);case 13:return this.mediaRecorder=e.sent,e.abrupt("break",24);case 17:return e.prev=17,e.t0=e.catch(10),console.error(e.t0),e.abrupt("continue",21);case 21:o++,e.next=8;break;case 24:if(this.mediaRecorder){e.next=35;break}return e.prev=25,e.next=28,this.getMediaRecorder(this.stream);case 28:this.mediaRecorder=e.sent,e.next=35;break;case 31:return e.prev=31,e.t1=e.catch(25),console.error(e.t1),e.abrupt("return",Promise.reject(d("NOT_SUPPORT")));case 35:this.mediaRecorder.onstop=function(e){},this.mediaRecorder.ondataavailable=function(e){e.data&&e.data.size>0&&a.recordedBlobs.push(e.data)},this.mediaRecorder.start(10);case 38:case"end":return e.stop()}}),e,this,[[10,17],[25,31]])})),s=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=a.apply(e,t);function i(e){h(o,n,r,i,s,"next",e)}function s(e){h(o,n,r,i,s,"throw",e)}i(void 0)}))},function(){return s.apply(this,arguments)})},{key:"stopRecorder",value:function(){this.mediaRecorder&&"recording"===this.mediaRecorder.state&&(this.mediaRecorder.stop(),this.recordVideo&&(this.recordVideo.controls=!0))}},{key:"playVideo",value:function(){if(this.recordedBlobs.length>0){var e=(this.recordedBlobs[0]||{}).type,t=new Blob(this.recordedBlobs,{type:e}),n=window.URL.createObjectURL(t);return this.recordVideo&&(this.recordVideo.src=n),{blobUrl:n}}}},{key:"pauseVideo",value:function(){this.recordVideo&&this.recordVideo.pause()}},{key:"downloadVideo",value:function(){if(this.recordedBlobs.length>0){var e=new Blob(this.recordedBlobs,{type:"video/mp4"}),t=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download="video.mp4",document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(t)}),100)}}},{key:"takePhoto",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.canvas,n=void 0===t?document.createElement("canvas"):t,r=e.filename,o=void 0===r?"photo.png":r,i=e.ratio,a=void 0===i?2:i;if(this.opened){var s=this.config.mirror,c=this.getRectWithAspectRatio(),l=c.width,d=c.height,u=l*a,f=d*a;n.width=u,n.height=f,n.style.width="".concat(l,"px"),n.style.height="".concat(d,"px");var h=n.getContext("2d");h.translate(u/2,f/2),s&&h.scale(-1,1),h.drawImage(this.mediaVideo,-u/2,-f/2,u,f);var p=n.toDataURL("image/png"),v=function(e,t){for(var n=e.split(","),r=n[0].match(/:(.*?);/)[1],o=atob(n[1]),i=o.length,a=new Uint8Array(i);i--;)a[i]=o.charCodeAt(i);return new File([a],t,{type:r})}(p,o);return{dataUrl:p,file:v}}}},{key:"getRectWithAspectRatio",value:function(e){var t,n,r=e||this.mediaVideo,o=r.offsetWidth,i=r.offsetHeight,a=(this.config.video||{}).aspectRatio,s=void 0===a?4/3:a;return s<=4/3?(t=i*s,n=i):(t=o,n=o/s),{width:t,height:n}}}],i&&p(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),r}(),m=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"recorder-container"},[t("div",{staticClass:"recorder-mask"}),e._v(" "),t("div",{staticClass:"recorder-video-wrapper"},[t("div",{ref:"mediaVideoContainer",staticClass:"recorder-video"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"},{name:"cbi-loading",rawName:"v-cbi-loading",value:e.loading,expression:"loading"}],staticClass:"recorder-video-loading"}),e._v(" "),t("video",{ref:"mediaVideo",attrs:{autoplay:"",muted:"",playsinline:""},domProps:{muted:!0}}),e._v(" "),t("video",{ref:"recordVideo",staticStyle:{position:"absolute",left:"0",top:"0",display:"none",background:"#7f7f7f"},attrs:{autoplay:"",playsinline:""}}),e._v(" "),t("canvas",{ref:"mediaCanvas"})]),e._v(" "),t("div",{staticClass:"recorder-btn-box"},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.stopRecord,expression:"!stopRecord"}],staticClass:"recorder-btn-item",on:{click:function(t){return e.handleRecord(!0)}}},[e._v("\n\t\t\t\t"+e._s("完成")+"\n\t\t\t")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.stopRecord,expression:"stopRecord"}],staticClass:"recorder-btn-succeed"},[t("span",{staticClass:"recorder-btn-item",on:{click:function(t){return e.handleRecord(!1)}}},[e._v("\n\t\t\t\t\t"+e._s("重新开始")+"\n\t\t\t\t")]),e._v(" "),t("span",{staticClass:"recorder-btn-item",on:{click:e.handleConfirm}},[e._v("\n\t\t\t\t\t"+e._s("下载")+"\n\t\t\t\t")])])])]),e._v(" "),t("span",{staticClass:"recorder-btn recorder-btn-close",on:{click:e.handleClose}},[t("svg",{staticClass:"icon",attrs:{t:"1699883910623",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1108",width:"200",height:"200"}},[t("path",{attrs:{d:"M566.97558594 521.09667969L856.8828125 231.18945312c14.63378906-14.63378906 14.63378906-38.75976563 0-53.39355468l-1.58203125-1.58203125c-14.63378906-14.63378906-38.75976563-14.63378906-53.39355469 0L512 466.51660156 222.09277344 176.21386719c-14.63378906-14.63378906-38.75976563-14.63378906-53.39355469 0l-1.58203125 1.58203125c-15.02929688 14.63378906-15.02929688 38.75976563 0 53.39355469l289.90722656 289.90722656L167.1171875 811.00390625c-14.63378906 14.63378906-14.63378906 38.75976563 0 53.39355469l1.58203125 1.58203125c14.63378906 14.63378906 38.75976563 14.63378906 53.39355469 0L512 576.07226563 801.90722656 865.97949219c14.63378906 14.63378906 38.75976563 14.63378906 53.39355469 0l1.58203125-1.58203125c14.63378906-14.63378906 14.63378906-38.75976563 0-53.39355469L566.97558594 521.09667969z","p-id":"1109"}})])])])};m._withStripped=!0;var y=r(748),g=r.n(y),b=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"el-loading-fade"},on:{"after-leave":e.handleAfterLeave}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-loading-mask",class:[e.customClass,{"is-fullscreen":e.fullscreen}],style:{backgroundColor:e.background||""}},[t("div",{staticClass:"el-loading-spinner"},[e.spinner?t("i",{class:e.spinner}):t("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[t("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none"}})]),e._v(" "),e.text?t("p",{staticClass:"el-loading-text"},[e._v("\n\t\t\t\t"+e._s(e.text)+"\n\t\t\t")]):e._e()])])])};function w(e,t,n,r,o,i,a,s){var c,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),a?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=c):o&&(c=s?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(e,t){return c.call(t),d(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:l}}b._withStripped=!0;var x=w({data:function(){return{text:null,spinner:null,background:null,fullscreen:!0,visible:!1,customClass:""}},methods:{handleAfterLeave:function(){this.$emit("after-leave")},setText:function(e){this.text=e}}},b,[],!1,null,"32d5e6ae",null).exports;const k=g().prototype.$isServer,O=/([\:\-\_]+(.))/g,E=/^moz([A-Z])/,S=k?0:Number(document.documentMode),_=function(e){return e.replace(O,(function(e,t,n,r){return r?n.toUpperCase():n})).replace(E,"Moz$1")};function P(e,t){if(!e||!t)return!1;if(-1!==t.indexOf(" "))throw new Error("className should not contain space.");return e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}function C(e,t){if(e){for(var n=e.className,r=(t||"").split(" "),o=0,i=r.length;o<i;o++){var a=r[o];a&&(e.classList?e.classList.add(a):P(e,a)||(n+=" "+a))}e.classList||e.setAttribute("class",n)}}function R(e,t){if(e&&t){for(var n=t.split(" "),r=" "+e.className+" ",o=0,i=n.length;o<i;o++){var a=n[o];a&&(e.classList?e.classList.remove(a):P(e,a)&&(r=r.replace(" "+a+" "," ")))}e.classList||e.setAttribute("class",(r||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,""))}}!k&&document.addEventListener,!k&&document.removeEventListener;const L=S<9?function(e,t){if(!k){if(!e||!t)return null;"float"===(t=_(t))&&(t="styleFloat");try{if("opacity"===t)try{return e.filters.item("alpha").opacity/100}catch(e){return 1}return e.style[t]||e.currentStyle?e.currentStyle[t]:null}catch(n){return e.style[t]}}}:function(e,t){if(!k){if(!e||!t)return null;"float"===(t=_(t))&&(t="cssFloat");try{var n=document.defaultView.getComputedStyle(e,"");return e.style[t]||n?n[t]:null}catch(n){return e.style[t]}}};let j,N=!1,T=!1;const V=function(){if(g().prototype.$isServer)return;let e=I.modalDom;return e?N=!0:(N=!1,e=document.createElement("div"),I.modalDom=e,e.addEventListener("touchmove",(function(e){e.preventDefault(),e.stopPropagation()})),e.addEventListener("click",(function(){I.doOnModalClick&&I.doOnModalClick()}))),e},$={},I={modalFade:!0,getInstance:function(e){return $[e]},register:function(e,t){e&&t&&($[e]=t)},deregister:function(e){e&&($[e]=null,delete $[e])},nextZIndex:function(){return I.zIndex++},modalStack:[],doOnModalClick:function(){const e=I.modalStack[I.modalStack.length-1];if(!e)return;const t=I.getInstance(e.id);t&&t.closeOnClickModal&&t.close()},openModal:function(e,t,n,r,o){if(g().prototype.$isServer)return;if(!e||void 0===t)return;this.modalFade=o;const i=this.modalStack;for(let t=0,n=i.length;t<n;t++)if(i[t].id===e)return;const a=V();C(a,"v-modal"),this.modalFade&&!N&&C(a,"v-modal-enter"),r&&r.trim().split(/\s+/).forEach((e=>C(a,e))),setTimeout((()=>{R(a,"v-modal-enter")}),200),n&&n.parentNode&&11!==n.parentNode.nodeType?n.parentNode.appendChild(a):document.body.appendChild(a),t&&(a.style.zIndex=t),a.tabIndex=0,a.style.display="",this.modalStack.push({id:e,zIndex:t,modalClass:r})},closeModal:function(e){const t=this.modalStack,n=V();if(t.length>0){const r=t[t.length-1];if(r.id===e)r.modalClass&&r.modalClass.trim().split(/\s+/).forEach((e=>R(n,e))),t.pop(),t.length>0&&(n.style.zIndex=t[t.length-1].zIndex);else for(let n=t.length-1;n>=0;n--)if(t[n].id===e){t.splice(n,1);break}}0===t.length&&(this.modalFade&&C(n,"v-modal-leave"),setTimeout((()=>{0===t.length&&(n.parentNode&&n.parentNode.removeChild(n),n.style.display="none",I.modalDom=void 0),R(n,"v-modal-leave")}),200))}};Object.defineProperty(I,"zIndex",{configurable:!0,get(){return T||(j=j||(g().prototype.$ELEMENT||{}).zIndex||2e3,T=!0),j},set(e){j=e}}),g().prototype.$isServer||window.addEventListener("keydown",(function(e){if(27===e.keyCode){const e=function(){if(!g().prototype.$isServer&&I.modalStack.length>0){const e=I.modalStack[I.modalStack.length-1];if(!e)return;return I.getInstance(e.id)}}();e&&e.closeOnPressEscape&&(e.handleClose?e.handleClose():e.handleAction?e.handleAction("cancel"):e.close())}}));var M=I;function A(e,t,n=300,r=!1){if(!e||!t)throw new Error("instance & callback is required");let o=!1;const i=function(){o||(o=!0,t&&t.apply(null,arguments))};r?e.$once("after-leave",i):e.$on("after-leave",i),setTimeout((()=>{i()}),n+100)}Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean;var U,B=g().extend(x),D={install:function(e){if(!e.prototype.$isServer){var t=function(t,r){r.value?e.nextTick((function(){r.modifiers.fullscreen?(t.originalPosition=L(document.body,"position"),t.originalOverflow=L(document.body,"overflow"),t.maskStyle.zIndex=M.nextZIndex(),C(t.mask,"is-fullscreen"),n(document.body,t,r)):(R(t.mask,"is-fullscreen"),r.modifiers.body?(t.originalPosition=L(document.body,"position"),["top","left"].forEach((function(e){var n="top"===e?"scrollTop":"scrollLeft";t.maskStyle[e]=t.getBoundingClientRect()[e]+document.body[n]+document.documentElement[n]-parseInt(L(document.body,"margin-".concat(e)),10)+"px"})),["height","width"].forEach((function(e){t.maskStyle[e]=t.getBoundingClientRect()[e]+"px"})),n(document.body,t,r)):(t.originalPosition=L(t,"position"),n(t,t,r)))})):(A(t.instance,(function(e){if(t.instance.hiding){t.domVisible=!1;var n=r.modifiers.fullscreen||r.modifiers.body?document.body:t;R(n,"el-loading-parent--relative"),R(n,"el-loading-parent--hidden"),t.instance.hiding=!1}}),300,!0),t.instance.visible=!1,t.instance.hiding=!0)},n=function(t,n,r){n.domVisible||"none"===L(n,"display")||"hidden"===L(n,"visibility")?n.domVisible&&!0===n.instance.hiding&&(n.instance.visible=!0,n.instance.hiding=!1):(Object.keys(n.maskStyle).forEach((function(e){n.mask.style[e]=n.maskStyle[e]})),"absolute"!==n.originalPosition&&"fixed"!==n.originalPosition&&"sticky"!==n.originalPosition&&C(t,"el-loading-parent--relative"),r.modifiers.fullscreen&&r.modifiers.lock&&C(t,"el-loading-parent--hidden"),n.domVisible=!0,t.appendChild(n.mask),e.nextTick((function(){n.instance.hiding?n.instance.$emit("after-leave"):n.instance.visible=!0})),n.domInserted=!0)};e.directive("cbi-loading",{bind:function(e,n,r){var o=e.getAttribute("element-loading-text"),i=e.getAttribute("element-loading-spinner"),a=e.getAttribute("element-loading-background"),s=e.getAttribute("element-loading-custom-class"),c=r.context,l=new B({el:document.createElement("div"),data:{text:c&&c[o]||o,spinner:c&&c[i]||i,background:c&&c[a]||a,customClass:c&&c[s]||s,fullscreen:!!n.modifiers.fullscreen}});e.instance=l,e.mask=l.$el,e.maskStyle={},n.value&&t(e,n)},update:function(e,n){e.instance.setText(e.getAttribute("element-loading-text")),n.oldValue!==n.value&&t(e,n)},unbind:function(e,n){e.domInserted&&(e.mask&&e.mask.parentNode&&e.mask.parentNode.removeChild(e.mask),t(e,{value:!1,modifiers:n.modifiers})),e.instance&&e.instance.$destroy()}})}}},F=g().extend(x),z={text:null,fullscreen:!0,body:!1,lock:!1,customClass:""};F.prototype.originalPosition="",F.prototype.originalOverflow="",F.prototype.close=function(){var e=this;this.fullscreen&&(U=void 0),A(this,(function(t){var n=e.fullscreen||e.body?document.body:e.target;R(n,"el-loading-parent--relative"),R(n,"el-loading-parent--hidden"),e.$el&&e.$el.parentNode&&e.$el.parentNode.removeChild(e.$el),e.$destroy()}),300),this.visible=!1};var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!g().prototype.$isServer){if("string"==typeof(e=function(e){for(let t=1,n=arguments.length;t<n;t++){let n=arguments[t]||{};for(let t in n)if(n.hasOwnProperty(t)){let r=n[t];void 0!==r&&(e[t]=r)}}return e}({},z,e)).target&&(e.target=document.querySelector(e.target)),e.target=e.target||document.body,e.target!==document.body?e.fullscreen=!1:e.body=!0,e.fullscreen&&U)return U;var t=e.body?document.body:e.target,n=new F({el:document.createElement("div"),data:e});return function(e,t,n){var r={};e.fullscreen?(n.originalPosition=L(document.body,"position"),n.originalOverflow=L(document.body,"overflow"),r.zIndex=M.nextZIndex()):e.body?(n.originalPosition=L(document.body,"position"),["top","left"].forEach((function(t){var n="top"===t?"scrollTop":"scrollLeft";r[t]=e.target.getBoundingClientRect()[t]+document.body[n]+document.documentElement[n]+"px"})),["height","width"].forEach((function(t){r[t]=e.target.getBoundingClientRect()[t]+"px"}))):n.originalPosition=L(t,"position"),Object.keys(r).forEach((function(e){n.$el.style[e]=r[e]}))}(e,t,n),"absolute"!==n.originalPosition&&"fixed"!==n.originalPosition&&"sticky"!==n.originalPosition&&C(t,"el-loading-parent--relative"),e.fullscreen&&e.lock&&C(t,"el-loading-parent--hidden"),t.appendChild(n.$el),g().nextTick((function(){n.visible=!0})),e.fullscreen&&(U=n),n}},q={install:function(e){e.use(D),e.prototype.$cbiLoading=G},directive:D,service:G};g().use(q);var W=w({props:{type:{type:String,default:"TakePhoto"},visible:{type:Boolean,default:!1},config:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,media:null,photo:null,stopRecord:!1}},watch:{visible:{handler:function(e){var t=this;e&&this.$nextTick((function(){var e=t.$refs,n=e.mediaVideoContainer,r=e.mediaVideo,o=e.recordVideo,i=t.config;t.media=new v({mediaVideo:r,recordVideo:o,config:i});var a=t.media.getRectWithAspectRatio(n),s=a.width,c=a.height;n.style.width="".concat(s,"px"),n.style.height="".concat(c,"px"),t.loading=!0,t.media.open().catch((function(e){console.error(e)})).finally((function(e){setTimeout((function(){t.loading=!1,"Recorder"===t.type&&t.media.startRecorder()}),1e3)}))}))},immediate:!0}},mounted:function(){},methods:{handleRecord:function(e){if(this.stopRecord=e,"TakePhoto"===this.type)if(e){this.$refs.mediaCanvas.style.display="block";var t=this.media.takePhoto({canvas:this.$refs.mediaCanvas}),n=t.dataUrl,r=t.file;this.photo={dataUrl:n,file:r}}else this.$refs.mediaCanvas.style.display="none";else e?(this.$refs.recordVideo.style.display="block",this.media.stopRecorder(),this.media.playVideo()):(this.media.pauseVideo(),this.$refs.recordVideo.style.display="none",this.media.startRecorder())},handleConfirm:function(){if("TakePhoto"===this.type){var e=this.photo;if(!e)return void console.error("请先拍照");this.$emit("takePhoto",e)}else this.media.downloadVideo();this.$emit("update:visible",!1)},handleClose:function(){this.media.close(),this.$emit("update:visible",!1)}}},m,[],!1,null,"b27ea260",null).exports,Z={install:function(e,t){e.prototype.$media=new v(t)}}}(),o}()}));
